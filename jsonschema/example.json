{
  "type": "object",
  "allOf": [
    {
      "if": {
        "required": ["key1"]
      },
      "then": {
        "required": ["status","key2"]
      },
      "else": {
        "required": ["key3"]
      },
      "switch": {
          "key": "key1",
          "cases": {
            "cak": {
              "required": ["cak_re"]
            },
            "cad": {
              "required": ["cad_re"]
            }
          },
          "default": {
              "required": ["default"]
          }
      },
      "properties": {
        "key1": {
          "type": "string",
          "maxLength": 15
        },
        "key2": {
          "type": "number",
          "maximum": 100,
          "minimum": 0,
          "defaultVal": 3,
          "replaceKey": "key2_p"
        },
        "status": {
          "type": "number",
          "enums": [0,1,2,3]
        },
        "key3": {
          "type": "string"
        },
        "data": {
          "type": "object",
          "properties": {
            "key1": {
              "type": "string"

            }
          }
        }
      }
    },
    {
      "script": [
        {
          "if": "key1=='1'",
          "then": "data.key1_cp=key1"
        },
        {
            "switch": "key2",
            "cases": {
              "'1'": "data.key_s=1",
              "'2'": "data.key_s=2"
            },
            "default": "data.key_s=3"
        },
        {
          "for": "k,v in data",
          "do": "rst=append(rst,k,'=',v,';')"
        },
        "delctx('k','v')"
      ]
    }
  ]
}